<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8"/>
    <title>人员信息导入</title>
    <meta name="renderer" content="webkit|ie-comp|ie-stand"/>
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"/>
    <meta name="viewport" content="width=device-width,user-scalable=yes, minimum-scale=0.4, initial-scale=0.8,target-densitydpi=low-dpi" />
    <meta http-equiv="Cache-Control" content="no-siteapp" />
    <link rel="stylesheet" th:href="@{~/static/lib/layui/css/layui.css}"/>
    <link rel="stylesheet" th:href="@{~/static/css/pay_manage.css}"/>
    <link rel="stylesheet" th:href="@{~/static/css/global.css}"/>
    <script type="text/javascript" src="https://cdn.bootcss.com/jquery/3.2.1/jquery.min.js"></script>
    <script th:src="@{~/static/lib/layui/layui.js}" charset="utf-8"></script>
    <script type="text/javascript" th:src="@{~/static/js/xadmin.js}"></script>
    <link rel="stylesheet" th:href="@{~/static/sweetalert/sweetalert.css}"/>
    <script type="text/javascript" th:src="@{~/static/sweetalert/sweetalert.min.js}"></script>
    <script type="text/javascript" th:src="@{~/static/sweetalert/xlalert.js}"></script>
</head>
<body>
<p class="pay_title">人员信息导入</p>
<div class="right_btn">
    <button id="download" class="btn" uploadUrl="http://119.29.230.78:9999/group1/M00/00/04/rBAQA1wwaxGAbJUdAABOAGYoOZk567.xls" >下载模板</button>
    <form id="fileUpload" method="post" action="#" enctype="multipart/form-data">
        <input id="moban" type="file" name="file" accept=".xls,.xlsx" onchange="validate_xls(this)"/>
        <button id="moban1" class="btn">导入信息清单</button>
    </form>
</div>
<!--excel 图片-->
<div class="img">
    <img th:src="@{~/static/images/excel.jpg}"/>
</div>
<div id="show" style="text-align: center;font-size:20px;margin-top:30px;"></div>
<div class="send_list">
    <button id="send" class="btn" onclick="modeImport()">发布清单</button>
</div>
<script>
    $('#moban').change(function () {
        var file = this.files[0];
        $('#show').text(file.name);
    })
    $('#download').click(function () {
        var uploadUrl=$(this).attr('uploadUrl');
        window.open(""+uploadUrl, "_blank");
    })
    function modeImport(){
        var fileInput = $('#moban').get(0).files[0];
        if(!fileInput){
            zlalert.alertError('请选择文件');
            return false;
        }else{
            var type = "file";          //后台接收时需要的参数名称，自定义即可
            var id = "moban";            //即input的id，用来寻找值
            var formData = new FormData();
            formData.append(type, $("#"+id)[0].files[0]);
            $.ajax({
                type: 'POST',
                url:'/kinder/personUpload',
                data: formData,
                async: false,
                cache: false,
                contentType: false,
                processData: false,
                success: function (data) {
                    alert(data);
                    $('#show').text('');
                    $('#fileUpload').trigger('reset');
                },
                error: function () {
                    //请求异常的回调
                    alert("文件类型或内容错误，请检查后上传");
                }
            });
        }

    }
</script>
</body>
</html>